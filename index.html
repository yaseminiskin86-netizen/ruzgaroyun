<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ramazan Quiz Show - Mobil Uyumlu</title>
    <style>
        :root { --accent: #ffd700; --correct: #27ae60; --wrong: #ff0000; }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body { 
            margin: 0; 
            background: #0a0500; 
            color: white; 
            font-family: 'Segoe UI', sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            overflow: hidden; 
            transition: background 0.3s; 
        }
        
        body.wrong-flash { background: var(--wrong); }

        /* Oyun Çerçevesi - Mobilde Esnek Yapı */
        #theater-frame { 
            position: relative; 
            width: 100vw; 
            max-width: 1100px; 
            height: 100vh; 
            max-height: 750px; 
            border: 10px solid #3d1f00; 
            background: #000; 
            overflow: hidden; 
            box-shadow: 0 0 50px rgba(0,0,0,1); 
        }

        /* Perdeler */
        .curtain { 
            position: absolute; 
            top: 0; 
            width: 50.5%; 
            height: 100%; 
            background: #990000; 
            z-index: 1000; 
            transition: transform 2s ease-in-out; 
            background-image: repeating-linear-gradient(to right, #700, #700 20px, #900 40px); 
        }
        #curtain-left { left: 0; } 
        #curtain-right { right: 0; }
        .open #curtain-left { transform: translateX(-100%); }
        .open #curtain-right { transform: translateX(100%); }

        /* Lobi Ekranı */
        #lobby {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            text-align: center;
            padding: 20px;
        }

        .start-button {
            background: linear-gradient(145deg, #27ae60, #1e8449);
            color: white;
            border: 3px solid #fff;
            padding: 20px 40px;
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            animation: pulse-green 2s infinite;
            width: 80%;
            max-width: 400px;
        }

        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(39, 174, 96, 0); }
            100% { box-shadow: 0 0 0 0 rgba(39, 174, 96, 0); }
        }

        /* Quiz Kartı - Mobilde Daha Geniş */
        #quiz-card { 
            position: absolute; 
            top: 45%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            width: 90%; 
            max-width: 600px; 
            background: rgba(255, 255, 255, 0.98); 
            color: #222; 
            padding: 20px; 
            border-radius: 15px; 
            display: none; 
            z-index: 500; 
            text-align: center; 
            border: 4px solid var(--accent); 
        }

        .opt-btn { 
            display: block; 
            width: 100%; 
            padding: 15px; 
            margin: 8px 0; 
            background: #2c3e50; 
            color: white; 
            border: none; 
            border-radius: 10px; 
            cursor: pointer; 
            font-size: 1.1rem; 
            font-weight: bold; 
        }

        .correct-btn { background: var(--correct) !important; }
        .wrong-btn { background: var(--wrong) !important; }

        /* Skor Tablosu - Mobil Uyarlaması */
        #leaderboard { 
            position: absolute; 
            bottom: 0; 
            width: 100%; 
            background: rgba(0, 0, 0, 0.9); 
            display: none; 
            z-index: 600; 
            padding: 10px 5px; 
            border-top: 2px solid var(--accent); 
        }

        .score-row { 
            display: flex; 
            justify-content: space-around; 
            flex-wrap: wrap;
            gap: 10px; 
        }

        .score-box { 
            text-align: center; 
            padding: 5px 10px; 
            border-radius: 8px; 
            background: #222; 
            border: 1px solid #444; 
            min-width: 70px; 
            flex: 1;
        }

        .player { border-color: var(--accent); background: #332200; }

        #mobile-hint {
            display: none;
            color: #ffd700;
            font-size: 1.2rem;
            margin-top: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <audio id="snd-bg-davul" loop><source src="https://www.soundjay.com/misc/sounds/snare-drum-1.mp3" type="audio/mpeg"></audio>
    <audio id="snd-correct"><source src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3" type="audio/mpeg"></audio>
    <audio id="snd-sad"><source src="https://www.myinstants.com/media/sounds/sad-tromboon-mister-p-1.mp3" type="audio/mpeg"></audio>

    <div id="lobby">
        <h1 style="font-size: clamp(2rem, 8vw, 4rem); color: var(--accent); margin-bottom: 20px;">RAMAZAN QUIZ SHOW</h1>
        <button class="start-button" onclick="launchGame()">OYUNU BAŞLAT</button>
        <div id="mobile-hint">
            DAVULLAR ÇALIYOR!<br>
            <span style="color: #00ff00;">Ekrana Dokun</span> veya <span style="color: #00ff00;">'S' Tuşuna Bas</span>
        </div>
    </div>

    <div id="theater-frame" onclick="triggerSceneOpening()">
        <div id="curtain-left" class="curtain"></div>
        <div id="curtain-right" class="curtain"></div>
        
        <img id="game-bg" src="5. sahne.jpg" style="width:100%; height:100%; object-fit: cover; opacity:0.5;">

        <div id="quiz-card">
            <h3 id="q-info" style="margin:0; color:#555;">SORU 1/10</h3>
            <h2 id="q-text" style="margin:15px 0; font-size: 1.4rem;">Yükleniyor...</h2>
            <div id="options"></div>
        </div>

        <div id="leaderboard">
            <div class="score-row" id="scores-container"></div>
        </div>
    </div>

<script>
    const bgDavul = document.getElementById('snd-bg-davul');
    const sndCorrect = document.getElementById('snd-correct');
    const sndSad = document.getElementById('snd-sad');
    
    let currentIdx = 0;
    let myScore = 0;
    let gameReadyToOpen = false;
    let isSceneOpened = false;
    let botlar = [{ name: "Hacivat", score: 0 }, { name: "Karagöz", score: 0 }, { name: "Çelebi", score: 0 }];

    const questions = [
        { q: "Ramazan ayında oruca başlanan vakit hangisidir?", a: ["İftar", "İmsak", "Kuşluk", "Öğle"], c: 1 },
        { q: "Camilerde minareler arasına asılan ışıklı yazı?", a: ["Mahya", "Afiş", "Tabela", "Fener"], c: 0 },
        { q: "İftarın vazgeçilmez, susamlı ekmeği hangisidir?", a: ["Bazlama", "Pide", "Somun", "Yufka"], c: 1 },
        { q: "Sahurda maniler eşliğinde ne çalınır?", a: ["Zurna", "Keman", "Davul", "Ney"], c: 2 },
        { q: "Oruç açma vaktine ne denir?", a: ["Sahur", "İmsak", "İftar", "Kuşluk"], c: 2 },
        { q: "Ramazan ayında kılınan özel namaz?", a: ["Cuma", "Teravih", "Bayram", "Vakit"], c: 1 },
        { q: "İftar vaktini duyuran meşhur gelenek?", a: ["Düdük", "Siren", "Ramazan Topu", "Çan"], c: 2 },
        { q: "Orucu hangi meyve ile açmak sünnettir?", a: ["Elma", "Hurma", "Üzüm", "İncir"], c: 1 },
        { q: "Kur'an-ı Kerim hangi gece indirilmiştir?", a: ["Berat", "Miraç", "Kadir Gecesi", "Mevlid"], c: 2 },
        { q: "Ramazan Bayramı kaç gündür?", a: ["1", "2", "3", "4"], c: 2 }
    ];

    function launchGame() {
        // Ses kilidini aç
        [bgDavul, sndCorrect, sndSad].forEach(a => { 
            a.volume = 0.95; 
            a.play().then(() => a.pause()).catch(() => {});
        });
        
        bgDavul.play();
        document.querySelector('.start-button').style.display = 'none';
        document.getElementById('mobile-hint').style.display = 'block';
        gameReadyToOpen = true;
    }

    // Hem klavye hem dokunma kontrolü
    window.addEventListener('keydown', (e) => {
        if (e.key.toLowerCase() === 's') triggerSceneOpening();
    });

    function triggerSceneOpening() {
        if (gameReadyToOpen && !isSceneOpened) {
            isSceneOpened = true;
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('theater-frame').classList.add('open');
            setTimeout(() => {
                document.getElementById('quiz-card').style.display = 'block';
                document.getElementById('leaderboard').style.display = 'block';
                loadQ();
            }, 2000);
        }
    }

    function loadQ() {
        const q = questions[currentIdx];
        document.getElementById('q-info').innerText = `SORU ${currentIdx + 1}/10`;
        document.getElementById('q-text').innerText = q.q;
        const box = document.getElementById('options');
        box.innerHTML = '';
        updateBoard();

        q.a.forEach((ans, i) => {
            const btn = document.createElement('button');
            btn.className = 'opt-btn';
            btn.innerText = ans;
            btn.onclick = (e) => {
                e.stopPropagation(); // Tıklamanın sahne açma fonksiyonunu tetiklemesini önle
                const buttons = document.querySelectorAll('.opt-btn');
                buttons.forEach(b => b.onclick = null);

                if (i === q.c) {
                    btn.classList.add('correct-btn');
                    myScore += 10;
                    sndCorrect.currentTime = 0;
                    sndCorrect.play();
                } else {
                    btn.classList.add('wrong-btn');
                    sndSad.currentTime = 0;
                    sndSad.play();
                    document.body.classList.add('wrong-flash');
                    setTimeout(() => document.body.classList.remove('wrong-flash'), 500);
                    buttons[q.c].classList.add('correct-btn');
                }
                
                botlar.forEach(b => { if(b.score < 90) b.score += Math.floor(Math.random()*11); });

                setTimeout(() => {
                    currentIdx++;
                    if(currentIdx < questions.length) loadQ();
                    else finish();
                }, 2000);
            };
            box.appendChild(btn);
        });
    }

    function updateBoard() {
        const container = document.getElementById('scores-container');
        let hepsi = [...botlar, { name: "SEN", score: myScore }].sort((a,b) => b.score - a.score);
        container.innerHTML = hepsi.map(p => `
            <div class="score-box ${p.name === 'SEN' ? 'player' : ''}">
                <span style="font-size:10px; color:#aaa; display:block;">${p.name}</span>
                <span style="font-size:18px; font-weight:bold; color:var(--accent);">${p.score}</span>
            </div>
        `).join('');
    }

    function finish() {
        document.getElementById('quiz-card').innerHTML = `
            <h1 style="color:var(--correct)">BİTTİ!</h1>
            <h2>Puanın: ${myScore}</h2>
            <button onclick="location.reload()" style="padding:15px 30px; cursor:pointer; background:#27ae60; color:white; border:none; border-radius:10px; font-weight:bold;">YENİDEN BAŞLA</button>
        `;
    }
</script>
</body>
</html>
